<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FITCORE - Admin Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <!-- Firebase Compat SDK (v10) - easiest for single-file apps -->
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore-compat.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#D6FF00',
                        dark: '#0A0A0A',
                        card: '#141414',
                    },
                    fontFamily: {
                        heading: ['Oswald', 'sans-serif'],
                        body: ['Poppins', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #0A0A0A;
            color: white;
        }
        h1, h2, h3, .nav-logo {
            font-family: 'Oswald', sans-serif;
            text-transform: uppercase;
        }
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #0A0A0A;
        }
        ::-webkit-scrollbar-thumb {
            background: #333;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #D6FF00;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body class="antialiased selection:bg-primary selection:text-black flex h-screen overflow-hidden">

    <!-- SIDEBAR -->
    <aside class="w-64 bg-card border-r border-gray-900 flex flex-col hidden md:flex">
        <div class="p-6 border-b border-gray-900">
            <div class="nav-logo text-3xl font-bold tracking-wider text-white">
                FIT<span class="text-primary">CORE</span>
            </div>
            <p class="text-xs text-gray-500 mt-1 uppercase tracking-widest">Admin Portal</p>
        </div>

        <nav class="flex-1 p-4 space-y-2 overflow-y-auto">
            <a onclick="switchTab('dashboard')" class="flex items-center gap-3 bg-primary text-black px-4 py-3 font-medium transition-colors cursor-pointer tab-link active">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"></path></svg>
                Dashboard
            </a>

            <!-- ORIGINAL + NEW LINKS -->
            <a onclick="switchTab('members')" class="flex items-center gap-3 text-gray-400 hover:text-white hover:bg-gray-900 px-4 py-3 font-medium transition-colors cursor-pointer tab-link">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>
                Members
            </a>
            <a onclick="switchTab('trainers')" class="flex items-center gap-3 text-gray-400 hover:text-white hover:bg-gray-900 px-4 py-3 font-medium transition-colors cursor-pointer tab-link">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>
                Trainers
            </a>
            <a onclick="switchTab('classes')" class="flex items-center gap-3 text-gray-400 hover:text-white hover:bg-gray-900 px-4 py-3 font-medium transition-colors cursor-pointer tab-link">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                Classes
            </a>
            <a onclick="switchTab('attendance')" class="flex items-center gap-3 text-gray-400 hover:text-white hover:bg-gray-900 px-4 py-3 font-medium transition-colors cursor-pointer tab-link">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2 2 2 0 01-2 2v-2m0-2h14M12 5v14"></path></svg>
                Attendance
            </a>
            <a onclick="switchTab('analytics')" class="flex items-center gap-3 text-gray-400 hover:text-white hover:bg-gray-900 px-4 py-3 font-medium transition-colors cursor-pointer tab-link">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path></svg>
                Analytics
            </a>
            <a onclick="switchTab('reports')" class="flex items-center gap-3 text-gray-400 hover:text-white hover:bg-gray-900 px-4 py-3 font-medium transition-colors cursor-pointer tab-link">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17l-4-4m0 0l-4 4m4-4V3"></path></svg>
                Reports
            </a>
            <a onclick="switchTab('inventory')" class="flex items-center gap-3 text-gray-400 hover:text-white hover:bg-gray-900 px-4 py-3 font-medium transition-colors cursor-pointer tab-link">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path></svg>
                Inventory
            </a>
            <a onclick="switchTab('leads')" class="flex items-center gap-3 text-gray-400 hover:text-white hover:bg-gray-900 px-4 py-3 font-medium transition-colors cursor-pointer tab-link">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2.01 2.01 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2"></path></svg>
                Leads
            </a>

            <a onclick="switchTab('settings')" class="flex items-center gap-3 text-gray-400 hover:text-white hover:bg-gray-900 px-4 py-3 font-medium transition-colors cursor-pointer tab-link">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                Settings
            </a>
        </nav>

        <div class="p-4 border-t border-gray-900">
            <a href="#" onclick="logout()" class="flex items-center gap-3 text-red-500 hover:text-red-400 px-4 py-3 font-medium transition-colors">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path></svg>
                Logout
            </a>
        </div>
    </aside>

    <!-- MAIN CONTENT -->
    <main class="flex-1 flex flex-col h-screen overflow-hidden">
        <!-- HEADER -->
        <header class="flex justify-between items-center p-6 border-b border-gray-900 bg-card/50 backdrop-blur-sm">
            <div class="flex items-center gap-4">
                <button class="md:hidden text-white">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
                </button>
                <h2 id="page-title" class="text-2xl font-bold tracking-wide">Dashboard</h2>
            </div>

            <div class="flex items-center gap-6">
                <!-- Search with filters trigger -->
                <div class="relative hidden sm:block">
                    <svg class="w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                    <input id="global-search" type="text" placeholder="Search members..." 
                           class="bg-dark border border-gray-800 text-sm text-white px-10 py-2 focus:outline-none focus:border-primary transition-colors w-64 placeholder-gray-600"
                           onkeyup="if(event.key==='Enter') filterMembers()">
                    <button onclick="showFilterModal()" class="absolute right-3 top-1/2 -translate-y-1/2 text-primary text-xs font-medium">FILTERS</button>
                </div>

                <!-- Notification Center -->
                <div class="relative cursor-pointer" onclick="toggleNotifications()">
                    <svg id="bell" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6 6 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 01-3 3H9a3 3 0 01-3-3v-1m6 0h6"></path>
                    </svg>
                    <span id="notif-count" class="absolute -top-1 -right-1 bg-red-500 text-white text-[10px] font-bold w-5 h-5 flex items-center justify-center rounded-full">0</span>
                </div>

                <!-- User -->
                <div class="flex items-center gap-3 border-l border-gray-800 pl-6">
                    <img src="https://ui-avatars.com/api/?name=Admin+User&background=D6FF00&color=000" alt="Admin" class="w-9 h-9 rounded-full">
                    <div class="hidden md:block">
                        <p class="text-sm font-semibold text-white leading-tight">Admin User</p>
                        <p class="text-xs text-primary leading-tight">Superadmin</p>
                    </div>
                </div>
            </div>
        </header>

        <!-- TAB CONTENTS -->
        <div class="flex-1 overflow-y-auto p-6 md:p-8">

            <!-- ==================== DASHBOARD TAB ==================== -->
            <div id="dashboard-tab" class="tab-content active">

                <div class="mb-8">
                    <h3 class="text-gray-400 font-light mb-1">Welcome back,</h3>
                    <h1 class="text-4xl font-bold text-white tracking-wide">SYSTEM <span class="text-primary">STATUS</span></h1>
                </div>

                <!-- KPI Cards -->
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-10">
                    <div class="bg-card border border-gray-900 p-6 hover:-translate-y-1 transition-transform duration-300">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <p class="text-gray-500 text-sm font-medium uppercase tracking-wider mb-1">Total Members</p>
                                <h3 id="total-members" class="text-3xl font-bold font-heading">0</h3>
                            </div>
                            <div class="p-2 bg-gray-900 text-primary">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>
                            </div>
                        </div>
                        <div id="member-growth" class="text-sm text-green-500 flex items-center gap-1"></div>
                    </div>

                    <div class="bg-card border border-gray-900 p-6 hover:-translate-y-1 transition-transform duration-300">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <p class="text-gray-500 text-sm font-medium uppercase tracking-wider mb-1">Monthly Revenue</p>
                                <h3 id="monthly-revenue" class="text-3xl font-bold font-heading">$0</h3>
                            </div>
                            <div class="p-2 bg-gray-900 text-primary">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                            </div>
                        </div>
                        <div id="revenue-growth" class="text-sm text-green-500 flex items-center gap-1"></div>
                    </div>

                    <div class="bg-card border border-gray-900 p-6 hover:-translate-y-1 transition-transform duration-300">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <p class="text-gray-500 text-sm font-medium uppercase tracking-wider mb-1">Active Trainers</p>
                                <h3 id="active-trainers" class="text-3xl font-bold font-heading">0</h3>
                            </div>
                            <div class="p-2 bg-gray-900 text-primary">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg>
                            </div>
                        </div>
                        <div class="text-sm text-gray-500 flex items-center gap-1">Live</div>
                    </div>

                    <div class="bg-card border border-gray-900 p-6 hover:-translate-y-1 transition-transform duration-300">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <p class="text-gray-500 text-sm font-medium uppercase tracking-wider mb-1">Pending Inquiries</p>
                                <h3 id="pending-leads" class="text-3xl font-bold font-heading">0</h3>
                            </div>
                            <div class="p-2 bg-gray-900 text-primary">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path></svg>
                            </div>
                        </div>
                        <div id="leads-status" class="text-sm text-red-500 flex items-center gap-1"></div>
                    </div>
                </div>

                <!-- Live Occupancy + Revenue Trend -->
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-10">
                    <!-- Live Occupancy -->
                    <div class="lg:col-span-1 bg-card border border-gray-900 p-6 rounded-xl">
                        <p class="text-gray-500 text-sm font-medium uppercase tracking-wider mb-4">Live Occupancy</p>
                        <div class="flex items-end justify-between mb-6">
                            <div>
                                <div id="current-occupancy" class="text-6xl font-bold font-heading text-primary">0</div>
                                <div id="capacity" class="text-2xl text-gray-400">/ 120</div>
                            </div>
                            <div class="text-right">
                                <div id="occupancy-percent" class="text-4xl font-bold text-green-500">0%</div>
                                <div class="text-xs text-gray-500">Moderate</div>
                            </div>
                        </div>
                        <div class="h-3 bg-gray-800 rounded-full overflow-hidden">
                            <div id="occupancy-bar" class="h-full bg-gradient-to-r from-primary to-green-400 w-0 transition-all"></div>
                        </div>
                    </div>

                    <!-- Revenue Trend -->
                    <div class="lg:col-span-2 bg-card border border-gray-900 p-6 rounded-xl">
                        <div class="flex justify-between mb-6">
                            <div>
                                <p class="text-gray-500 text-sm font-medium uppercase tracking-wider">Revenue Trend (30 days)</p>
                                <p id="revenue-total" class="text-3xl font-bold font-heading">$0</p>
                            </div>
                        </div>
                        <canvas id="revenueChart" height="110"></canvas>
                    </div>
                </div>

                <!-- Membership Plan Breakdown + At-Risk Members -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-10">
                    <!-- Doughnut -->
                    <div class="bg-card border border-gray-900 p-6 rounded-xl">
                        <h3 class="text-xl font-bold font-heading tracking-wide mb-6">Membership Plan Breakdown</h3>
                        <canvas id="planDoughnut" height="220"></canvas>
                    </div>

                    <!-- At-Risk Members -->
                    <div class="bg-card border border-gray-900 p-6 rounded-xl">
                        <h3 class="text-xl font-bold font-heading tracking-wide mb-4 flex items-center gap-2">
                            At-Risk Members <span id="at-risk-count" class="bg-red-500/20 text-red-500 text-xs px-2 py-0.5 rounded">0</span>
                        </h3>
                        <div id="at-risk-list" class="space-y-3 text-sm max-h-80 overflow-y-auto pr-2"></div>
                    </div>
                </div>

                <!-- Recent Registrations -->
                <div class="bg-card border border-gray-900 overflow-hidden">
                    <div class="p-6 border-b border-gray-900 flex justify-between items-center">
                        <h3 class="text-xl font-bold font-heading tracking-wide">Recent Registrations</h3>
                        <a onclick="switchTab('members')" class="text-sm text-primary hover:text-white transition-colors cursor-pointer">View All Members</a>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left border-collapse">
                            <thead>
                                <tr class="bg-dark/50 text-gray-400 text-sm uppercase tracking-wider border-b border-gray-900">
                                    <th class="p-4 font-medium">Member</th>
                                    <th class="p-4 font-medium">Plan</th>
                                    <th class="p-4 font-medium">Join Date</th>
                                    <th class="p-4 font-medium">Status</th>
                                    <th class="p-4 font-medium text-right">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="recent-registrations" class="text-sm"></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- ==================== OTHER TABS (minimal real-time structure) ==================== -->
            <div id="members-tab" class="tab-content">
                <h2 class="text-3xl font-bold font-heading mb-6">Members Management</h2>
                <div class="bg-card border border-gray-900 p-6">
                    <p class="text-gray-400 mb-4">Full member list with real-time updates from Firestore collection <span class="font-mono text-primary">"members"</span></p>
                    <div id="members-table-container" class="overflow-x-auto"></div>
                </div>
            </div>

            <div id="trainers-tab" class="tab-content">
                <h2 class="text-3xl font-bold font-heading mb-6">Trainers Management</h2>
                <div class="bg-card border border-gray-900 p-6">
                    <p class="text-gray-400 mb-4">Staff, availability, ratings &amp; payout tracker (Firestore: <span class="font-mono text-primary">"trainers"</span>)</p>
                    <div id="trainers-table-container" class="overflow-x-auto"></div>
                </div>
            </div>

            <div id="classes-tab" class="tab-content">
                <h2 class="text-3xl font-bold font-heading mb-6">Classes &amp; Schedule</h2>
                <div class="bg-card border border-gray-900 p-6">
                    <p class="text-gray-400 mb-4">Templates, capacity, waitlists (Firestore: <span class="font-mono text-primary">"classes"</span>)</p>
                    <div id="classes-table-container" class="overflow-x-auto"></div>
                </div>
            </div>

            <div id="attendance-tab" class="tab-content">
                <h2 class="text-3xl font-bold font-heading mb-6">Attendance &amp; Check-ins</h2>
                <div class="bg-card border border-gray-900 p-6">
                    <p class="text-gray-400 mb-4">Live check-ins + export (Firestore: <span class="font-mono text-primary">"attendance"</span>)</p>
                    <div id="attendance-table-container" class="overflow-x-auto"></div>
                </div>
            </div>

            <div id="analytics-tab" class="tab-content">
                <h2 class="text-3xl font-bold font-heading mb-6">Analytics</h2>
                <div class="bg-card border border-gray-900 p-6">
                    <p class="text-gray-400">Advanced charts &amp; filters coming soon. Data pulled live from Firestore.</p>
                </div>
            </div>

            <div id="reports-tab" class="tab-content">
                <h2 class="text-3xl font-bold font-heading mb-6">Reports</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <button onclick="generateReport('revenue')" class="bg-card border border-gray-900 hover:border-primary p-8 text-left transition-colors">
                        <span class="block text-primary text-sm font-medium">EXPORT</span>
                        <span class="text-2xl font-bold">Revenue Report</span>
                        <span class="text-xs text-gray-500 block mt-2">PDF / CSV</span>
                    </button>
                    <button onclick="generateReport('membership')" class="bg-card border border-gray-900 hover:border-primary p-8 text-left transition-colors">
                        <span class="block text-primary text-sm font-medium">EXPORT</span>
                        <span class="text-2xl font-bold">Membership Report</span>
                    </button>
                    <button onclick="generateReport('attendance')" class="bg-card border border-gray-900 hover:border-primary p-8 text-left transition-colors">
                        <span class="block text-primary text-sm font-medium">EXPORT</span>
                        <span class="text-2xl font-bold">Attendance Report</span>
                    </button>
                </div>
            </div>

            <div id="inventory-tab" class="tab-content">
                <h2 class="text-3xl font-bold font-heading mb-6">Inventory &amp; Maintenance</h2>
                <div class="bg-card border border-gray-900 p-6">
                    <p class="text-gray-400 mb-4">Equipment list with alerts (Firestore: <span class="font-mono text-primary">"inventory"</span>)</p>
                    <div id="inventory-table-container" class="overflow-x-auto"></div>
                </div>
            </div>

            <div id="leads-tab" class="tab-content">
                <h2 class="text-3xl font-bold font-heading mb-6">Leads &amp; Inquiries</h2>
                <div class="bg-card border border-gray-900 p-6">
                    <p class="text-gray-400 mb-4">Follow-up status (Firestore: <span class="font-mono text-primary">"leads"</span>)</p>
                    <div id="leads-table-container" class="overflow-x-auto"></div>
                </div>
            </div>

            <div id="settings-tab" class="tab-content">
                <h2 class="text-3xl font-bold font-heading mb-6">Settings</h2>
                <div class="bg-card border border-gray-900 p-8 max-w-md">
                    <p class="text-gray-400">System configuration. All data is synced in real-time across clients via Firebase.</p>
                </div>
            </div>
        </div>
    </main>

    <!-- NOTIFICATION DROPDOWN -->
    <div id="notification-dropdown" class="hidden absolute top-20 right-8 bg-card border border-gray-900 w-96 rounded-xl shadow-2xl z-50 overflow-hidden">
        <div class="p-4 border-b border-gray-900 flex justify-between items-center">
            <span class="font-semibold">Notifications</span>
            <span onclick="markAllRead()" class="text-primary text-xs cursor-pointer hover:underline">Mark all read</span>
        </div>
        <div id="notification-list" class="max-h-96 overflow-y-auto text-sm"></div>
    </div>

    <!-- SIMPLE FILTER MODAL -->
    <div id="filter-modal" class="hidden fixed inset-0 bg-black/70 flex items-center justify-center z-50">
        <div class="bg-card border border-gray-900 w-full max-w-md rounded-2xl p-8">
            <h3 class="text-xl font-bold mb-6">Member Filters</h3>
            <div class="space-y-4">
                <div>
                    <label class="text-xs text-gray-400 block mb-1">Plan</label>
                    <select id="filter-plan" class="w-full bg-dark border border-gray-700 p-3 rounded-lg">
                        <option value="">All Plans</option>
                    </select>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="text-xs text-gray-400 block mb-1">Status</label>
                        <select id="filter-status" class="w-full bg-dark border border-gray-700 p-3 rounded-lg">
                            <option value="">Any</option>
                            <option value="ACTIVE">Active</option>
                            <option value="PENDING">Pending</option>
                        </select>
                    </div>
                    <div>
                        <label class="text-xs text-gray-400 block mb-1">Joined After</label>
                        <input type="date" id="filter-date" class="w-full bg-dark border border-gray-700 p-3 rounded-lg">
                    </div>
                </div>
            </div>
            <div class="flex gap-3 mt-8">
                <button onclick="hideFilterModal()" class="flex-1 py-3 border border-gray-700 hover:bg-gray-900 rounded-lg">Cancel</button>
                <button onclick="applyFilters()" class="flex-1 py-3 bg-primary text-black font-semibold rounded-lg">Apply Filters</button>
            </div>
        </div>
    </div>

    <script>
        // ====================== FIREBASE CONFIG ======================
        // ðŸ”¥ðŸ”¥ðŸ”¥ REPLACE WITH YOUR ACTUAL FIREBASE CONFIG ðŸ”¥ðŸ”¥ðŸ”¥
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY_HERE",
            authDomain: "your-project-id.firebaseapp.com",
            projectId: "your-project-id",
            storageBucket: "your-project-id.appspot.com",
            messagingSenderId: "123456789012",
            appId: "1:123456789012:web:abcdef1234567890"
        };

        let db;
        try {
            firebase.initializeApp(firebaseConfig);
            db = firebase.firestore();
            console.log("%cFirebase connected successfully", "color:#D6FF00; font-weight:bold");
        } catch (e) {
            console.warn("%cFirebase not configured yet. Replace the config object above.", "color:#ff9900");
        }

        // ====================== CHARTS ======================
        let revenueChartInstance = null;
        let doughnutInstance = null;

        function initRevenueChart(data = [3200, 4100, 3800, 5200, 4800, 6700]) {
            const ctx = document.getElementById('revenueChart');
            if (revenueChartInstance) revenueChartInstance.destroy();
            revenueChartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['1 Oct','5 Oct','10 Oct','15 Oct','20 Oct','25 Oct'],
                    datasets: [{
                        label: 'Revenue',
                        data: data,
                        borderColor: '#D6FF00',
                        tension: 0.4,
                        borderWidth: 3,
                        pointRadius: 0
                    }]
                },
                options: {
                    plugins: { legend: { display: false } },
                    scales: {
                        y: { grid: { color: '#222' }, ticks: { color: '#666' } },
                        x: { grid: { color: '#222' }, ticks: { color: '#666' } }
                    }
                }
            });
        }

        function initDoughnut(plans) {
            const ctx = document.getElementById('planDoughnut');
            if (doughnutInstance) doughnutInstance.destroy();
            const colors = ['#D6FF00', '#22C55E', '#3B82F6', '#EF4444', '#8B5CF6'];
            doughnutInstance = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(plans),
                    datasets: [{
                        data: Object.values(plans),
                        backgroundColor: colors,
                        borderColor: '#141414',
                        borderWidth: 3
                    }]
                },
                options: {
                    plugins: { legend: { position: 'bottom', labels: { color: '#aaa', padding: 20 } } }
                }
            });
        }

        // ====================== TAB SWITCHING ======================
        function switchTab(tab) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            document.getElementById(tab + '-tab').classList.add('active');

            document.querySelectorAll('.tab-link').forEach(link => link.classList.remove('bg-primary', 'text-black'));
            const activeLink = Array.from(document.querySelectorAll('.tab-link')).find(l => l.getAttribute('onclick').includes(`'${tab}'`));
            if (activeLink) activeLink.classList.add('bg-primary', 'text-black');

            document.getElementById('page-title').textContent = tab.charAt(0).toUpperCase() + tab.slice(1);

            // Load data for selected tab
            if (tab === 'dashboard') loadDashboard();
            if (tab === 'members') loadMembersTable();
            if (tab === 'trainers') loadTrainersTable();
            if (tab === 'classes') loadClassesTable();
            if (tab === 'attendance') loadAttendanceTable();
            if (tab === 'leads') loadLeadsTable();
            if (tab === 'inventory') loadInventoryTable();
        }

        // ====================== DASHBOARD DATA (REAL-TIME) ======================
        function loadDashboard() {
            if (!db) return;

            // Total Members
            db.collection("members").onSnapshot(snapshot => {
                document.getElementById("total-members").textContent = snapshot.size.toLocaleString();
            });

            // Monthly Revenue (assume a document with current month total)
            db.collection("stats").doc("revenue").onSnapshot(doc => {
                if (doc.exists) {
                    const rev = doc.data().monthly || 0;
                    document.getElementById("monthly-revenue").textContent = "$" + rev.toLocaleString();
                    document.getElementById("revenue-total").textContent = "$" + rev.toLocaleString();
                }
            });

            // Active Trainers
            db.collection("trainers").where("status", "==", "active").onSnapshot(snapshot => {
                document.getElementById("active-trainers").textContent = snapshot.size;
            });

            // Pending Leads
            db.collection("leads").where("status", "==", "pending").onSnapshot(snapshot => {
                document.getElementById("pending-leads").textContent = snapshot.size;
                document.getElementById("leads-status").innerHTML = snapshot.size > 0 ? 
                    `<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 17h8m0 0v-8m0 8l-8-8-4 4-6-6"></path></svg> Needs attention` : 'All clear';
            });

            // Recent Registrations (real-time)
            db.collection("members").orderBy("joinDate", "desc").limit(5).onSnapshot(snapshot => {
                let html = '';
                snapshot.forEach(doc => {
                    const m = doc.data();
                    const statusClass = m.status === 'ACTIVE' ? 'bg-primary/10 text-primary' : 'bg-red-500/10 text-red-500';
                    html += `
                        <tr class="border-b border-gray-900 hover:bg-gray-900/30 transition-colors">
                            <td class="p-4 flex items-center gap-3">
                                <div class="w-8 h-8 bg-gray-800 rounded-full flex justify-center items-center text-primary font-bold">${m.name ? m.name.substring(0,2).toUpperCase() : '??'}</div>
                                <div>
                                    <p class="font-semibold text-white">${m.name || 'Unknown'}</p>
                                    <p class="text-xs text-gray-500">${m.email || ''}</p>
                                </div>
                            </td>
                            <td class="p-4 text-gray-300">${m.plan || 'â€”'}</td>
                            <td class="p-4 text-gray-400">${m.joinDate || 'â€”'}</td>
                            <td class="p-4"><span class="${statusClass} px-3 py-1 text-xs font-semibold tracking-wide">${m.status || 'PENDING'}</span></td>
                            <td class="p-4 text-right"><button class="text-gray-400 hover:text-white">â€¢â€¢â€¢</button></td>
                        </tr>`;
                });
                document.getElementById("recent-registrations").innerHTML = html || '<tr><td colspan="5" class="p-8 text-center text-gray-500">No recent registrations yet</td></tr>';
            });

            // At-Risk Members (expires in <14 days)
            const today = new Date();
            const in14Days = new Date(today.getTime() + 14 * 86400000);
            db.collection("members").where("membershipEnd", "<", firebase.firestore.Timestamp.fromDate(in14Days))
                .onSnapshot(snapshot => {
                    let html = '';
                    let count = 0;
                    snapshot.forEach(doc => {
                        const m = doc.data();
                        const endDate = m.membershipEnd ? m.membershipEnd.toDate().toLocaleDateString() : 'â€”';
                        html += `<div class="flex justify-between items-center bg-gray-900/50 p-3 rounded-lg">
                            <div>
                                <p class="font-medium">${m.name || 'Member'}</p>
                                <p class="text-xs text-red-400">Expires ${endDate}</p>
                            </div>
                            <span class="text-xs bg-red-500/20 text-red-400 px-2 py-1 rounded">AT RISK</span>
                        </div>`;
                        count++;
                    });
                    document.getElementById("at-risk-list").innerHTML = html || '<p class="text-green-500 text-center py-6">No members at risk ðŸŽ‰</p>';
                    document.getElementById("at-risk-count").textContent = count;
                });

            // Membership Plan Doughnut
            db.collection("members").onSnapshot(snapshot => {
                const plans = {};
                snapshot.forEach(doc => {
                    const plan = doc.data().plan || "Other";
                    plans[plan] = (plans[plan] || 0) + 1;
                });
                initDoughnut(plans);
            });

            // Live Occupancy (example: stats/occupancy doc)
            db.collection("stats").doc("occupancy").onSnapshot(doc => {
                if (doc.exists) {
                    const data = doc.data();
                    const percent = Math.round((data.current / data.capacity) * 100);
                    document.getElementById("current-occupancy").textContent = data.current;
                    document.getElementById("capacity").textContent = `/ ${data.capacity}`;
                    document.getElementById("occupancy-percent").textContent = percent + "%";
                    document.getElementById("occupancy-bar").style.width = percent + "%";
                }
            });

            // Sample revenue trend (replace with your own collection if needed)
            initRevenueChart();
        }

        // ====================== NOTIFICATIONS ======================
        function loadNotifications() {
            if (!db) return;
            db.collection("notifications").orderBy("timestamp", "desc").limit(15).onSnapshot(snapshot => {
                let unread = 0;
                let html = '';
                snapshot.forEach(doc => {
                    const n = doc.data();
                    if (!n.read) unread++;
                    html += `
                        <div class="p-4 border-b border-gray-800 hover:bg-gray-900/50 ${!n.read ? 'bg-primary/5' : ''}">
                            <div class="flex justify-between">
                                <p class="text-sm">${n.message || 'New activity'}</p>
                                <span class="text-[10px] text-gray-500">${n.timestamp ? new Date(n.timestamp.seconds * 1000).toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'}) : ''}</span>
                            </div>
                        </div>`;
                });
                document.getElementById("notification-list").innerHTML = html || '<div class="p-8 text-center text-gray-500">No new notifications</div>';
                document.getElementById("notif-count").textContent = unread;
            });
        }

        function toggleNotifications() {
            const dd = document.getElementById("notification-dropdown");
            dd.classList.toggle("hidden");
        }

        function markAllRead() {
            if (!db) return alert("Firebase not connected");
            // In production you would update read status
            alert("All notifications marked as read (demo)");
            document.getElementById("notif-count").textContent = "0";
        }

        // ====================== OTHER TABLES (real-time) ======================
        function loadMembersTable() {
            if (!db) return;
            const container = document.getElementById("members-table-container");
            db.collection("members").onSnapshot(snapshot => {
                let html = `<table class="w-full"><thead><tr class="bg-dark/50 text-xs uppercase"><th class="p-3 text-left">Name</th><th>Plan</th><th>Join Date</th><th>Status</th></tr></thead><tbody>`;
                snapshot.forEach(doc => {
                    const m = doc.data();
                    html += `<tr class="border-b border-gray-800"><td class="p-3">${m.name}</td><td>${m.plan}</td><td>${m.joinDate}</td><td><span class="text-xs px-2 py-0.5 ${m.status==='ACTIVE'?'bg-primary text-black':'bg-red-400 text-white'} rounded">${m.status}</span></td></tr>`;
                });
                html += `</tbody></table>`;
                container.innerHTML = html;
            });
        }

        function loadTrainersTable() { /* same pattern as above */ document.getElementById("trainers-table-container").innerHTML = `<p class="p-8 text-center text-gray-500">Real-time trainers from Firestore collection "trainers"</p>`; }
        function loadClassesTable() { document.getElementById("classes-table-container").innerHTML = `<p class="p-8 text-center text-gray-500">Real-time classes from Firestore collection "classes"</p>`; }
        function loadAttendanceTable() { document.getElementById("attendance-table-container").innerHTML = `<p class="p-8 text-center text-gray-500">Real-time attendance from Firestore collection "attendance"</p>`; }
        function loadLeadsTable() { document.getElementById("leads-table-container").innerHTML = `<p class="p-8 text-center text-gray-500">Real-time leads from Firestore collection "leads"</p>`; }
        function loadInventoryTable() { document.getElementById("inventory-table-container").innerHTML = `<p class="p-8 text-center text-gray-500">Real-time inventory from Firestore collection "inventory"</p>`; }

        // ====================== REPORTS ======================
        function generateReport(type) {
            alert(`Generating ${type} report as PDF/CSV...\n\n(In production this would use jsPDF or server-side export)`);
        }

        // ====================== FILTER MODAL ======================
        function showFilterModal() {
            document.getElementById("filter-modal").classList.remove("hidden");
        }
        function hideFilterModal() {
            document.getElementById("filter-modal").classList.add("hidden");
        }
        function applyFilters() {
            hideFilterModal();
            alert("Filters applied â€“ table would refresh with Firestore query in production");
        }
        function filterMembers() {
            const term = document.getElementById("global-search").value.toLowerCase();
            if (term.length < 2) return;
            alert(`Searching for "${term}" across members (Firestore full-text would be used in production)`);
        }

        // ====================== LOGOUT ======================
        function logout() {
            if (confirm("Sign out of FITCORE Admin?")) {
                window.location.reload();
            }
        }

        // ====================== INIT ======================
        window.onload = function() {
            // Default to dashboard
            switchTab('dashboard');

            // Start real-time listeners
            loadNotifications();

            // Demo revenue chart (you can replace with Firestore data)
            initRevenueChart();

            console.log("%cFITCORE Admin Dashboard ready with live Firebase sync ðŸš€", "color:#D6FF00; font-size:13px");
            console.log("%câ†’ Replace firebaseConfig object with your real project settings", "color:#888");
        };
    </script>
</body>
</html>
